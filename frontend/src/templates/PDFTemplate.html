<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Información del Colaborador - SGMM</title>
    <style>
        /* Reset y configuración base */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', 'Helvetica', sans-serif;
            font-size: 12px;
            line-height: 1.4;
            color: #333;
            background: #fff;
        }

        /* Contenedor principal - Tamaño Carta (8.5" x 11") */
        .pdf-container {
            width: 816px; /* 8.5" * 96 DPI */
            height: 1056px; /* 11" * 96 DPI */
            margin: 0 auto;
            padding: 40px;
            background: #fff;
            position: relative;
        }

        /* Encabezado */
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            padding-bottom: 15px;
            border-bottom: 2px solid #e0e0e0;
        }

        .logo-section {
            display: flex;
            align-items: center;
        }

        .logo {
            width: 60px;
            height: 60px;
            background: #f0f0f0;
            border: 1px solid #ddd;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 15px;
            font-size: 10px;
            color: #666;
        }

        .company-info h1 {
            font-size: 18px;
            font-weight: bold;
            color: #2c3e50;
            margin-bottom: 5px;
        }

        .company-info p {
            font-size: 10px;
            color: #666;
        }

        .generation-info {
            text-align: right;
            font-size: 10px;
            color: #666;
        }

        /* Sección del colaborador */
        .employee-section {
            margin-bottom: 25px;
        }

        .section-title {
            font-size: 14px;
            font-weight: bold;
            color: #2c3e50;
            margin-bottom: 15px;
            padding: 8px 12px;
            background: #f8f9fa;
            border-left: 4px solid #3498db;
        }

        .employee-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 20px;
        }

        .field-group {
            display: flex;
            flex-direction: column;
        }

        .field-label {
            font-size: 10px;
            font-weight: bold;
            color: #666;
            margin-bottom: 3px;
            text-transform: uppercase;
        }

        .field-value {
            font-size: 12px;
            color: #333;
            padding: 5px 8px;
            background: #f8f9fa;
            border: 1px solid #e0e0e0;
            border-radius: 3px;
        }

        /* Sección de dependientes */
        .dependents-section {
            margin-bottom: 25px;
        }

        .dependents-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
        }

        .dependents-table th {
            background: #3498db;
            color: white;
            padding: 8px 6px;
            font-size: 10px;
            font-weight: bold;
            text-align: left;
            border: 1px solid #2980b9;
        }

        .dependents-table td {
            padding: 6px;
            font-size: 10px;
            border: 1px solid #e0e0e0;
            vertical-align: top;
        }

        .dependents-table tr:nth-child(even) {
            background: #f8f9fa;
        }

        .dependents-table tr:nth-child(odd) {
            background: #fff;
        }

        /* Sección de firma */
        .signature-section {
            margin-top: 30px;
            padding-top: 20px;
            border-top: 2px solid #e0e0e0;
        }

        .signature-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-top: 20px;
        }

        .signature-field {
            display: flex;
            flex-direction: column;
        }

        .signature-line {
            border-bottom: 1px solid #333;
            height: 30px;
            margin-bottom: 5px;
        }

        .signature-label {
            font-size: 10px;
            color: #666;
            text-align: center;
        }

        /* Pie de página */
        .footer {
            position: absolute;
            bottom: 20px;
            left: 40px;
            right: 40px;
            text-align: center;
            font-size: 9px;
            color: #666;
            border-top: 1px solid #e0e0e0;
            padding-top: 10px;
        }

        /* Utilidades */
        .text-center { text-align: center; }
        .text-right { text-align: right; }
        .font-bold { font-weight: bold; }
        .text-sm { font-size: 10px; }
        .text-xs { font-size: 9px; }
        .mb-2 { margin-bottom: 8px; }
        .mt-2 { margin-top: 8px; }

        /* Responsive para impresión */
        @media print {
            .pdf-container {
                width: 100%;
                height: 100%;
                margin: 0;
                padding: 20px;
            }
        }
    </style>
</head>
<body>
    <div class="pdf-container" id="pdf-template">
        <!-- Encabezado -->
        <div class="header">
            <div class="logo-section">
                <div class="logo">LOGO</div>
                <div class="company-info">
                    <h1 id="company-name">Siegfried Rhein</h1>
                    <p id="company-code">Código: SR-001</p>
                </div>
            </div>
            <div class="generation-info">
                <p>Generado el: <span id="generation-date">15 de enero de 2025</span></p>
                <p>Por: <span id="generated-by">Sistema SGMM</span></p>
            </div>
        </div>

        <!-- Información del Colaborador -->
        <div class="employee-section">
            <h2 class="section-title">INFORMACIÓN DEL COLABORADOR</h2>
            
            <div class="employee-grid">
                <div class="field-group">
                    <span class="field-label">Número de Empleado</span>
                    <div class="field-value" id="employee-number">3619</div>
                </div>
                <div class="field-group">
                    <span class="field-label">Nombre Completo</span>
                    <div class="field-value" id="employee-full-name">Jonahatan Angeles Rosas</div>
                </div>
                <div class="field-group">
                    <span class="field-label">Email Corporativo</span>
                    <div class="field-value" id="employee-email">jonahatan.angeles@siegfried.com.mx</div>
                </div>
                <div class="field-group">
                    <span class="field-label">Fecha de Nacimiento</span>
                    <div class="field-value" id="employee-birth-date">24 de junio de 1983</div>
                </div>
                <div class="field-group">
                    <span class="field-label">Edad</span>
                    <div class="field-value" id="employee-age">41 años</div>
                </div>
                <div class="field-group">
                    <span class="field-label">Género</span>
                    <div class="field-value" id="employee-gender">Masculino</div>
                </div>
                <div class="field-group">
                    <span class="field-label">Fecha de Ingreso</span>
                    <div class="field-value" id="employee-hire-date">15 de enero de 2020</div>
                </div>
                <div class="field-group">
                    <span class="field-label">Departamento</span>
                    <div class="field-value" id="employee-department">Tecnología</div>
                </div>
                <div class="field-group">
                    <span class="field-label">Posición</span>
                    <div class="field-value" id="employee-position">Desarrollador Senior</div>
                </div>
                <div class="field-group">
                    <span class="field-label">Número de Póliza</span>
                    <div class="field-value" id="employee-policy-number">POL-2025-3619</div>
                </div>
            </div>
        </div>

        <!-- Información de Dependientes -->
        <div class="dependents-section">
            <h2 class="section-title">DEPENDIENTES REGISTRADOS</h2>
            
            <div id="dependents-count" class="mb-2">
                <strong>Total de dependientes: <span id="dependents-total">2</span></strong>
            </div>

            <table class="dependents-table" id="dependents-table">
                <thead>
                    <tr>
                        <th>ID Dependiente</th>
                        <th>Nombre Completo</th>
                        <th>Fecha de Nacimiento</th>
                        <th>Edad</th>
                        <th>Género</th>
                        <th>Parentesco</th>
                        <th>Estado</th>
                    </tr>
                </thead>
                <tbody id="dependents-tbody">
                    <!-- Los dependientes se insertarán dinámicamente aquí -->
                    <tr>
                        <td>3619-a01</td>
                        <td>María Angeles López</td>
                        <td>15 de marzo de 2010</td>
                        <td>14 años</td>
                        <td>Femenino</td>
                        <td>Hijo(a)</td>
                        <td>Activo</td>
                    </tr>
                    <tr>
                        <td>3619-a02</td>
                        <td>Carlos Angeles López</td>
                        <td>22 de agosto de 2012</td>
                        <td>12 años</td>
                        <td>Masculino</td>
                        <td>Hijo(a)</td>
                        <td>Activo</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <!-- Sección de Firma -->
        <div class="signature-section">
            <h2 class="section-title">ACEPTACIÓN Y FIRMA</h2>
            
            <p class="text-sm mb-2">
                Por medio de la presente, confirmo que la información aquí contenida es veraz y completa, 
                y autorizo el uso de estos datos para los fines del sistema de gestión de seguros médicos.
            </p>

            <div class="signature-grid">
                <div class="signature-field">
                    <div class="signature-line"></div>
                    <div class="signature-label">Firma del Colaborador</div>
                </div>
                <div class="signature-field">
                    <div class="signature-line"></div>
                    <div class="signature-label">Fecha</div>
                </div>
            </div>

            <div class="signature-grid mt-2">
                <div class="signature-field">
                    <div class="signature-line"></div>
                    <div class="signature-label">Nombre Completo</div>
                </div>
                <div class="signature-field">
                    <div class="signature-line"></div>
                    <div class="signature-label">Número de Empleado</div>
                </div>
            </div>
        </div>

        <!-- Pie de página -->
        <div class="footer">
            <p>
                Sistema de Gestión de Seguros Médicos (SGMM) - 
                Generado automáticamente el <span id="footer-date">15 de enero de 2025</span> - 
                Página 1 de 1
            </p>
        </div>
    </div>

    <script>
        // Script para llenar datos dinámicamente
        function populateTemplate(data) {
            // Datos del empleado
            document.getElementById('employee-number').textContent = data.employee.id || '';
            document.getElementById('employee-full-name').textContent = data.employee.full_name || '';
            document.getElementById('employee-email').textContent = data.employee.email || '';
            document.getElementById('employee-birth-date').textContent = formatDate(data.employee.birth_date) || '';
            document.getElementById('employee-age').textContent = calculateAge(data.employee.birth_date) + ' años' || '';
            document.getElementById('employee-gender').textContent = formatGender(data.employee.gender) || '';
            document.getElementById('employee-hire-date').textContent = formatDate(data.employee.hire_date) || '';
            document.getElementById('employee-department').textContent = data.employee.department || '';
            document.getElementById('employee-position').textContent = data.employee.position || '';
            document.getElementById('employee-policy-number').textContent = data.employee.policy_number || '';

            // Datos de la compañía
            document.getElementById('company-name').textContent = data.company.name || '';
            document.getElementById('company-code').textContent = 'Código: ' + (data.company.code || '');

            // Fecha de generación
            const now = new Date();
            const dateStr = now.toLocaleDateString('es-MX', {
                year: 'numeric',
                month: 'long',
                day: 'numeric'
            });
            document.getElementById('generation-date').textContent = dateStr;
            document.getElementById('footer-date').textContent = dateStr;

            // Dependientes
            const dependents = data.dependents || [];
            document.getElementById('dependents-total').textContent = dependents.length;

            const tbody = document.getElementById('dependents-tbody');
            tbody.innerHTML = '';

            dependents.forEach(dependent => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${dependent.dependent_id || dependent.id}</td>
                    <td>${formatFullName(dependent.first_name, dependent.paternal_last_name, dependent.maternal_last_name)}</td>
                    <td>${formatDate(dependent.birth_date)}</td>
                    <td>${calculateAge(dependent.birth_date)} años</td>
                    <td>${formatGender(dependent.gender)}</td>
                    <td>${getRelationshipName(dependent.relationship_type_id, data.relationshipTypes)}</td>
                    <td>${formatStatus(dependent.status)}</td>
                `;
                tbody.appendChild(row);
            });
        }

        // Funciones auxiliares
        function formatDate(dateString) {
            if (!dateString) return '';
            const date = new Date(dateString);
            return date.toLocaleDateString('es-MX', {
                year: 'numeric',
                month: 'long',
                day: 'numeric'
            });
        }

        function calculateAge(birthDate) {
            if (!birthDate) return 0;
            const birth = new Date(birthDate);
            const today = new Date();
            let age = today.getFullYear() - birth.getFullYear();
            const monthDiff = today.getMonth() - birth.getMonth();
            if (monthDiff < 0 || (monthDiff === 0 && today.getDate() < birth.getDate())) {
                age--;
            }
            return age;
        }

        function formatGender(gender) {
            return gender === 'M' ? 'Masculino' : 'Femenino';
        }

        function formatStatus(status) {
            return status === 'ACTIVE' ? 'Activo' : 'Inactivo';
        }

        function formatFullName(firstName, paternalLastName, maternalLastName) {
            const parts = [firstName];
            if (paternalLastName) parts.push(paternalLastName);
            if (maternalLastName) parts.push(maternalLastName);
            return parts.join(' ');
        }

        function getRelationshipName(relationshipTypeId, relationshipTypes) {
            const relationshipType = relationshipTypes.find(rt => rt.id === relationshipTypeId);
            return relationshipType ? relationshipType.name : 'Desconocido';
        }
    </script>
</body>
</html>
